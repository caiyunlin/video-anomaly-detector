# ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ

## å¼‚å¸¸æ£€æµ‹ Prompt ç¤ºä¾‹

### ğŸš¨ å®‰å…¨ç›‘æ§

#### äººå‘˜å®‰å…¨
```
æ£€æµ‹äººå‘˜è·Œå€’ã€æ‘”å€’æˆ–çªç„¶å€’åœ°çš„è¡Œä¸º
```

```
è¯†åˆ«äººå‘˜ä¹‹é—´çš„å†²çªã€æ‰“æ–—æˆ–æš´åŠ›è¡Œä¸º
```

```
ç›‘æµ‹äººå‘˜æ˜¯å¦æ­£ç¡®ä½©æˆ´å®‰å…¨å¸½å’Œé˜²æŠ¤è®¾å¤‡
```

#### å…¥ä¾µæ£€æµ‹
```
æ£€æµ‹æœªæˆæƒäººå‘˜è¿›å…¥é™åˆ¶åŒºåŸŸ
```

```
è¯†åˆ«ç¿»è¶Šå›´æ ã€æ”€çˆ¬æˆ–éæ­£å¸¸è¿›å…¥è¡Œä¸º
```

```
ç›‘æµ‹å¤œé—´æˆ–éå·¥ä½œæ—¶é—´çš„å¼‚å¸¸äººå‘˜æ´»åŠ¨
```

### ğŸ”¥ ç«ç¾å’Œå±é™©å“ç›‘æ§

```
æ£€æµ‹ç«ç„°ã€çƒŸé›¾æˆ–ç‡ƒçƒ§è¿¹è±¡
```

```
è¯†åˆ«å±é™©åŒ–å­¦å“æ³„æ¼æˆ–å¼‚å¸¸æ°”ä½“é‡Šæ”¾
```

```
ç›‘æµ‹é«˜æ¸©è®¾å¤‡å¼‚å¸¸æˆ–è¿‡çƒ­ç°è±¡
```

### ğŸš— äº¤é€šç›‘æ§

```
æ£€æµ‹è½¦è¾†è¿è§„åœè½¦æˆ–å ç”¨åº”æ€¥é€šé“
```

```
è¯†åˆ«äº¤é€šäº‹æ•…æˆ–è½¦è¾†ç¢°æ’
```

```
ç›‘æµ‹è¡Œäººè¿è§„ç©¿è¶Šæˆ–åœ¨å±é™©åŒºåŸŸæ´»åŠ¨
```

### ğŸ­ å·¥ä¸šå®‰å…¨

```
æ£€æµ‹è®¾å¤‡å¼‚å¸¸è¿è½¬æˆ–æ•…éšœè¿¹è±¡
```

```
è¯†åˆ«ç”Ÿäº§çº¿ä¸Šçš„äº§å“ç¼ºé™·æˆ–å¼‚å¸¸
```

```
ç›‘æµ‹å·¥ä½œäººå‘˜æ˜¯å¦éµå¾ªå®‰å…¨æ“ä½œè§„ç¨‹
```

### ğŸª é›¶å”®ç›‘æ§

```
æ£€æµ‹é¡¾å®¢çš„å¼‚å¸¸è¡Œä¸ºæˆ–å¯ç–‘æ´»åŠ¨
```

```
è¯†åˆ«å•†å“è¢«ç›—æˆ–ç ´åè¡Œä¸º
```

```
ç›‘æµ‹åº—å†…äººæµèšé›†æˆ–æ‹¥æŒ¤æƒ…å†µ
```

## æœ€ä½³å®è·µå»ºè®®

### ğŸ“ Prompt ç¼–å†™æŠ€å·§

1. **å…·ä½“æ˜ç¡®**: è¯¦ç»†æè¿°è¦æ£€æµ‹çš„å¼‚å¸¸ç±»å‹
   - âŒ ä¸å¥½: "æ£€æµ‹å¼‚å¸¸"
   - âœ… å¥½: "æ£€æµ‹äººå‘˜åœ¨å·¥ä½œåŒºåŸŸå†…è·Œå€’æˆ–æ‘”å€’"

2. **åŒ…å«ä¸Šä¸‹æ–‡**: æä¾›åœºæ™¯ä¿¡æ¯æœ‰åŠ©äºæé«˜å‡†ç¡®æ€§
   - âœ… "åœ¨ç”Ÿäº§è½¦é—´ç›‘æµ‹å·¥äººæ˜¯å¦æ­£ç¡®ä½©æˆ´å®‰å…¨å¸½"
   - âœ… "åœ¨åœè½¦åœºæ£€æµ‹è½¦è¾†è¿è§„åœæ”¾åœ¨æ¶ˆé˜²é€šé“"

3. **å¤šé‡æ¡ä»¶**: å¯ä»¥åŒæ—¶æ£€æµ‹å¤šç§å¼‚å¸¸
   - âœ… "æ£€æµ‹ç«ç¾ã€çƒŸé›¾æˆ–å…¶ä»–å®‰å…¨éšæ‚£ï¼ŒåŒ…æ‹¬å¼‚å¸¸é«˜æ¸©æˆ–åŒ–å­¦å“æ³„æ¼"

4. **é¿å…ä¸»è§‚åˆ¤æ–­**: ä¸“æ³¨äºå¯è§‚å¯Ÿçš„è¡Œä¸º
   - âŒ ä¸å¥½: "æ£€æµ‹å¯ç–‘äººå‘˜"
   - âœ… å¥½: "æ£€æµ‹äººå‘˜é•¿æ—¶é—´é€—ç•™æˆ–åœ¨éå¼€æ”¾æ—¶é—´æ´»åŠ¨"

### ğŸ¥ è§†é¢‘è´¨é‡è¦æ±‚

#### æ¨èè§„æ ¼
- **åˆ†è¾¨ç‡**: 720p (1280x720) æˆ–æ›´é«˜
- **å¸§ç‡**: 15-30 FPS
- **æ—¶é•¿**: å»ºè®® 5-60 ç§’
- **æ ¼å¼**: MP4 (H.264 ç¼–ç ) æ¨è
- **æ–‡ä»¶å¤§å°**: å°äº 50MB

#### è´¨é‡ä¼˜åŒ–
- ç¡®ä¿å……è¶³çš„å…‰ç…§æ¡ä»¶
- é¿å…å‰§çƒˆçš„æ‘„åƒå¤´æŠ–åŠ¨
- ä¿æŒå…³é”®åŒºåŸŸåœ¨ç”»é¢ä¸­å¤®
- å‡å°‘èƒŒæ™¯å™ªéŸ³å’Œå¹²æ‰°

### âš¡ æ€§èƒ½ä¼˜åŒ–

#### è§†é¢‘é¢„å¤„ç†
```python
# ç¤ºä¾‹ï¼šå‹ç¼©è§†é¢‘ä»¥æé«˜å¤„ç†é€Ÿåº¦
import cv2

def compress_video(input_path, output_path, target_width=720):
    cap = cv2.VideoCapture(input_path)
    
    # è·å–åŸå§‹è§†é¢‘å±æ€§
    fps = cap.get(cv2.CAP_PROP_FPS)
    width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
    height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
    
    # è®¡ç®—æ–°çš„å°ºå¯¸
    if width > target_width:
        new_width = target_width
        new_height = int(height * (target_width / width))
    else:
        new_width, new_height = width, height
    
    # è®¾ç½®è¾“å‡ºè§†é¢‘ç¼–ç å™¨
    fourcc = cv2.VideoWriter_fourcc(*'mp4v')
    out = cv2.VideoWriter(output_path, fourcc, fps, (new_width, new_height))
    
    while True:
        ret, frame = cap.read()
        if not ret:
            break
            
        # è°ƒæ•´å¸§å¤§å°
        if width > target_width:
            frame = cv2.resize(frame, (new_width, new_height))
        
        out.write(frame)
    
    cap.release()
    out.release()
```

#### å¸§é‡‡æ ·ç­–ç•¥
- çŸ­è§†é¢‘ (< 10ç§’): æ¯ç§’é‡‡æ · 1-2 å¸§
- ä¸­ç­‰è§†é¢‘ (10-30ç§’): æ¯ 2-3 ç§’é‡‡æ · 1 å¸§
- é•¿è§†é¢‘ (> 30ç§’): å‡åŒ€é‡‡æ · 10-15 å¸§

### ğŸ”§ é…ç½®è°ƒä¼˜

#### Azure OpenAI å‚æ•°
```python
# æ¨èé…ç½®
{
    "temperature": 0.1,      # ä½æ¸©åº¦è·å¾—æ›´ä¸€è‡´çš„ç»“æœ
    "max_tokens": 2000,      # è¶³å¤Ÿçš„ä»¤ç‰Œæ•°è·å–è¯¦ç»†åˆ†æ
    "top_p": 0.9,           # é€‚ä¸­çš„ top_p å€¼
}
```

#### å®¹å™¨èµ„æºé…ç½®
```yaml
# Azure Container Apps æ¨èé…ç½®
resources:
  requests:
    cpu: "1.0"
    memory: "2Gi"
  limits:
    cpu: "2.0" 
    memory: "4Gi"
```

## å¸¸è§åœºæ™¯é…ç½®

### ğŸ¢ åŠå…¬æ¥¼ç›‘æ§

**æ£€æµ‹ç›®æ ‡**: äººå‘˜å®‰å…¨ã€å…¥ä¾µæ£€æµ‹
**æ¨è Prompt**:
```
ç›‘æµ‹åŠå…¬åŒºåŸŸå†…äººå‘˜è·Œå€’ã€å†²çªæˆ–æœªæˆæƒäººå‘˜è¿›å…¥ï¼Œ
ç‰¹åˆ«å…³æ³¨éå·¥ä½œæ—¶é—´çš„å¼‚å¸¸æ´»åŠ¨
```

**é…ç½®å»ºè®®**:
- ç½®ä¿¡åº¦é˜ˆå€¼: 70%
- é‡‡æ ·é—´éš”: 2ç§’
- æœ€å¤§åˆ†æå¸§æ•°: 10

### ğŸ­ å·¥å‚è½¦é—´

**æ£€æµ‹ç›®æ ‡**: å·¥ä¸šå®‰å…¨ã€è®¾å¤‡ç›‘æ§
**æ¨è Prompt**:
```
æ£€æµ‹ç”Ÿäº§è½¦é—´å†…å·¥äººè¿åå®‰å…¨è§„ç¨‹ï¼ŒåŒ…æ‹¬æœªä½©æˆ´é˜²æŠ¤è£…å¤‡ã€
è¿›å…¥å±é™©åŒºåŸŸæˆ–è®¾å¤‡å¼‚å¸¸è¿è½¬
```

**é…ç½®å»ºè®®**:
- ç½®ä¿¡åº¦é˜ˆå€¼: 80%
- é‡‡æ ·é—´éš”: 1ç§’
- æœ€å¤§åˆ†æå¸§æ•°: 15

### ğŸª å•†ä¸šåœºæ‰€

**æ£€æµ‹ç›®æ ‡**: å®‰å…¨é˜²èŒƒã€è¡Œä¸ºç›‘æ§
**æ¨è Prompt**:
```
è¯†åˆ«å•†åº—å†…é¡¾å®¢çš„å¼‚å¸¸è¡Œä¸ºï¼ŒåŒ…æ‹¬å•†å“ç›—çªƒã€ç ´åè¡Œä¸º
æˆ–äººç¾¤èšé›†é€ æˆçš„å®‰å…¨éšæ‚£
```

**é…ç½®å»ºè®®**:
- ç½®ä¿¡åº¦é˜ˆå€¼: 75%
- é‡‡æ ·é—´éš”: 1.5ç§’
- æœ€å¤§åˆ†æå¸§æ•°: 12

## é›†æˆç¤ºä¾‹

### ä¸è­¦æŠ¥ç³»ç»Ÿé›†æˆ

```python
import requests
import json

def send_alert(analysis_result):
    """å‘é€è­¦æŠ¥åˆ°ç›‘æ§ä¸­å¿ƒ"""
    if analysis_result['has_anomaly'] and analysis_result['confidence_score'] > 0.8:
        alert_data = {
            'type': 'video_anomaly',
            'severity': 'high' if analysis_result['confidence_score'] > 0.9 else 'medium',
            'description': analysis_result['description'],
            'timestamp': time.time(),
            'confidence': analysis_result['confidence_score']
        }
        
        # å‘é€åˆ°è­¦æŠ¥ç³»ç»Ÿ
        response = requests.post(
            'https://your-alert-system.com/api/alerts',
            json=alert_data,
            headers={'Authorization': 'Bearer your-token'}
        )
        
        return response.status_code == 200
    
    return False
```

### ä¸æ•°æ®åº“é›†æˆ

```python
import sqlite3
from datetime import datetime

def save_analysis_result(video_file, analysis_result):
    """ä¿å­˜åˆ†æç»“æœåˆ°æ•°æ®åº“"""
    conn = sqlite3.connect('anomaly_detection.db')
    cursor = conn.cursor()
    
    cursor.execute('''
        INSERT INTO analysis_results 
        (video_file, has_anomaly, confidence_score, anomaly_type, description, timestamp)
        VALUES (?, ?, ?, ?, ?, ?)
    ''', (
        video_file,
        analysis_result['has_anomaly'],
        analysis_result['confidence_score'],
        analysis_result.get('anomaly_type', ''),
        analysis_result['description'],
        datetime.now().isoformat()
    ))
    
    conn.commit()
    conn.close()
```

## æ•…éšœæ’é™¤æŒ‡å—

### åˆ†æå‡†ç¡®æ€§é—®é¢˜

1. **ç½®ä¿¡åº¦è¿‡ä½**
   - æ£€æŸ¥è§†é¢‘è´¨é‡å’Œæ¸…æ™°åº¦
   - ä¼˜åŒ– prompt æè¿°
   - ç¡®ä¿ç›®æ ‡è¡Œä¸ºåœ¨ç”»é¢ä¸­æ¸…æ™°å¯è§

2. **è¯¯æŠ¥ç‡è¿‡é«˜**
   - æé«˜ç½®ä¿¡åº¦é˜ˆå€¼
   - ç»†åŒ– prompt æè¿°
   - å¢åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯

3. **æ¼æŠ¥æƒ…å†µ**
   - é™ä½ç½®ä¿¡åº¦é˜ˆå€¼
   - å¢åŠ é‡‡æ ·å¸§æ•°
   - ä¼˜åŒ–è§†é¢‘è´¨é‡

### æ€§èƒ½ä¼˜åŒ–

1. **å¤„ç†é€Ÿåº¦æ…¢**
   - å‹ç¼©è§†é¢‘æ–‡ä»¶
   - å‡å°‘é‡‡æ ·å¸§æ•°
   - ä½¿ç”¨æ›´é«˜æ€§èƒ½çš„ Azure å®ä¾‹

2. **å†…å­˜ä½¿ç”¨è¿‡é«˜**
   - é™åˆ¶æœ€å¤§æ–‡ä»¶å¤§å°
   - ä¼˜åŒ–å¸§æå–ç®—æ³•
   - å¢åŠ å®¹å™¨å†…å­˜é…ç½®

é€šè¿‡éµå¾ªè¿™äº›æœ€ä½³å®è·µï¼Œæ‚¨å¯ä»¥è·å¾—æ›´å‡†ç¡®ã€æ›´å¯é çš„è§†é¢‘å¼‚å¸¸æ£€æµ‹ç»“æœã€‚